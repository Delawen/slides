.. _migrate-from-older-version:

Migrate from older versions of GeoNetwork
#########################################

On a frequent basis, we would want to migrate to a newer version of GeoNetwork. Migration between minor versions are easier than migration between major versions, but sometimes you will have to perform a major migration to keep up to date with latest features and bug fixing.

Default method
==============

There is a default procedure for migration that simply consist in deploying the new version of GeoNetwork with the old database and data directory. On the next startup, GeoNetwork will detect a new version and should be able to migrate transparently to the user.

.. warning:: Always do a backup of the database and the data directory before attempting any upgrade, as a failed migration can leave the system on an unconsistent state.

But although this method works for most use cases, there is a chance that custom modifications of GeoNetwork may lead to errors on the automatic migration scripts, specially when migrating from 2.x versions.

Manual migration
================

On case of failure of the automatic procedure, we can always try a manual migration. This manual migration can have two different approaches:

Apply manually the scripts
--------------------------

If the default method fails, a qualified technician can try to apply manually one by one all the migration scripts available on GeoNetwork and check where they fail. It is advisable to migrate step by step only upgrading to the immediately newer version instead of trying to do all the migration in one single step.

.. warning:: Even if the execution of a script does not throw any error, that doesn't mean the migration was successful. Always check that GeoNetwork is working fine and no data was lost in the process.

Harvest the data
----------------

If you are not familiar with the database and the data directory structure of GeoNetwork, it may be a bit complex to manually apply and fix the scripts. On this cases, you can always failback to harvest all the data from the old GeoNetwork instance to the new instance. 

.. warning:: With this method you will lose all the configuration data like harvesters, mail settings and user and groups privileges.

You will not harvest users and groups with this method, so you will have to manually re-create them on the new GeoNetwork instance and make sure metadata is assigned to the proper users and groups.

.. note:: It is advisable to ask a qualified technician for a migration script for the custom configuration of the portal.
